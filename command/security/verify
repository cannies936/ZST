from discord.ui import Button, View

@bot.tree.command(name="verifysetup", description="èªè¨¼ç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚")
@app_commands.describe(role="èªè¨¼å¾Œã«ä»˜ä¸ã™ã‚‹ãƒ­ãƒ¼ãƒ«")
async def verifysetup(interaction: discord.Interaction, role: discord.Role):
    class VerifyButton(View):
        def __init__(self):
            super().__init__(timeout=None)

        @discord.ui.button(label="âœ… èªè¨¼ã™ã‚‹", style=discord.ButtonStyle.green)
        async def verify(self, interaction_button: discord.Interaction, button: Button):
            member = interaction_button.user
            try:
                await member.add_roles(role)
                await interaction_button.response.send_message(
                    f"âœ… **{member.display_name}** ã•ã‚“ã‚’èªè¨¼ã—ã¾ã—ãŸï¼", ephemeral=True
                )
            except discord.Forbidden:
                await interaction_button.response.send_message(
                    "âš ï¸ æ¨©é™ä¸è¶³ã§ãƒ­ãƒ¼ãƒ«ã‚’ä»˜ä¸ã§ãã¾ã›ã‚“ã€‚", ephemeral=True
                )

    embed = discord.Embed(
        title="ğŸ” èªè¨¼ãŒå¿…è¦ã§ã™",
        description="ä¸‹ã® **èªè¨¼ã™ã‚‹** ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€ã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ ã—ã¦ãã ã•ã„ã€‚",
        color=discord.Color.green()
    )

    await interaction.response.send_message("âœ… èªè¨¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼", ephemeral=True)
    await interaction.channel.send(embed=embed, view=VerifyButton())